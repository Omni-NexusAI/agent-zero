aW1wb3J0IHsgY3JlYXRlU3RvcmUgfSBmcm9tICIvanMvQWxwaW5lU3RvcmUu
anMiOwppbXBvcnQgeyB1cGRhdGVDaGF0SW5wdXQsIHNlbmRNZXNzYWdlIH0g
ZnJvbSAiL2luZGV4LmpzIjsKaW1wb3J0IHsgc2xlZXAgfSBmcm9tICIvanMv
c2xlZXAuanMiOwppbXBvcnQgeyBzdG9yZSBhcyBtaWNyb3Bob25lU2V0dGlu
Z1N0b3JlIH0gZnJvbSAiL2NvbXBvbmVudHMvc2V0dGluZ3Mvc3BlZWNoL21p
Y3JvcGhvbmUtc2V0dGluZy1zdG9yZS5qcyI7Cgpjb25zdCBTdGF0dXMgPSB7
CiAgSU5BQ1RJVkU6ICJpbmFjdGl2ZSIsCiAgQUNUSVZBVElORzogImFjdGl2
YXRpbmciLAogIExJU1RFTklORzogImxpc3RlbmluZyIsCiAgUkVDT1JESU5H
OiAicmVjb3JkaW5nIiwKICBXQUlUSU5HOiAid2FpdGluZyIsCiAgUFJPQ0VT
U0lORzogInByb2Nlc3NpbmciLAp9OwoKLy8gQ3JlYXRlIHRoZSBzcGVlY2gg
c3RvcmUKY29uc3QgbW9kZWwgPSB7CiAgLy8gU1RUIFNldHRpbmdzCiAgc3R0
X21vZGVsX3NpemU6ICJ0aW55IiwKICBzdHRfbGFuZ3VhZ2U6ICJlbiIsCiAg
c3R0X3NpbGVuY2VfdGhyZXNob2xkOiAwLjA1LAogIHN0dF9zaWxlbmNlX2R1
cmF0aW9uOiAxMDAwLAogIHN0dF93YWl0aW5nX3RpbWVvdXQ6IDIwMDAsCgog
IC8vIFRUUyBTZXR0aW5ncwogIHR0c19rb2tvcm86IGZhbHNlLAogIHR0c19z
cGVlZDogMS4xLAoKICAvLyBUVFMgU3RhdGUKICBpc1NwZWFraW5nOiBmYWxz
ZSwKICBzcGVha2luZ0lkOiAiIiwKICBzcGVha2luZ1RleHQ6ICIiLAogIGN1
cnJlbnRBdWRpbzogbnVsbCwKICBhdWRpb0VsOiBudWxsLAogIGF1ZGlvQ29u
dGV4dDogbnVsbCwKICB1c2VySGFzSW50ZXJhY3RlZDogZmFsc2UsCiAgc3Rv
cFNwZWVjaENoYWluOiBmYWxzZSwKICB0dHNTdHJlYW06IG51bGwsCgogIC8v
IFNUVCBTdGF0ZQogIG1pY3JvcGhvbmVJbnB1dDogbnVsbCwKICBpc1Byb2Nl
c3NpbmdDbGljazogZmFsc2UsCiAgc2VsZWN0ZWREZXZpY2U6IG51bGwsCgog
IC8vIEdldHRlciBmb3IgbWljU3RhdHVzIC0gZGVsZWdhdGVzIHRvIG1pY3Jv
cGhvbmVJbnB1dAogIGdldCBtaWNTdGF0dXMoKSB7CiAgICByZXR1cm4gdGhp
cy5taWNyb3Bob25lSW5wdXQ/LnN0YXR1cyB8fCBTdGF0dXMuSU5BQ1RJVkU7
CiAgfSwKCiAgdXBkYXRlTWljcm9waG9uZUJ1dHRvblVJKCkgewogICAgY29u
c3QgbWljcm9waG9uZUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlk
KCJtaWNyb3Bob25lLWJ1dHRvbiIpOwogICAgaWYgKCFtaWNyb3Bob25lQnV0
dG9uKSByZXR1cm47CiAgICBjb25zdCBzdGF0dXMgPSB0aGlzLm1pY1N0YXR1
czsKICAgIG1pY3JvcGhvbmVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgKICAg
ICAgIm1pYy1pbmFjdGl2ZSIsCiAgICAgICJtaWMtYWN0aXZhdGluZyIsCiAg
ICAgICJtaWMtbGlzdGVuaW5nIiwKICAgICAgIm1pYy1yZWNvcmRpbmciLAog
ICAgICAibWljLXdhaXRpbmciLAogICAgICAibWljLXByb2Nlc3NpbmciCiAg
ICApOwogICAgbWljcm9waG9uZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKGBtaWMt
JHtzdGF0dXMudG9Mb3dlckNhc2UoKX1gKTsKICAgIG1pY3JvcGhvbmVCdXR0
b24uc2V0QXR0cmlidXRlKCJkYXRhLXN0YXR1cyIsIHN0YXR1cyk7CiAgfSwK
CiAgYXN5bmMgaGFuZGxlTWljcm9waG9uZUNsaWNrKCkgewogICAgaWYgKHRo

aXMuaXNQcm9jZXNzaW5nQ2xpY2spIHJldHVybjsKICAgIHRoaXMuaXNQcm9j
ZXNzaW5nQ2xpY2sgPSB0cnVlOwogICAgdHJ5IHsKICAgICAgLy8gcmVzZXQg
bWljIGlucHV0IGlmIGRldmljZSBoYXMgY2hhbmdlZCBpbiBzZXR0aW5ncwog
ICAgICBjb25zdCBkZXZpY2UgPSBtaWNyb3Bob25lU2V0dGluZ1N0b3JlLmdl
dFNlbGVjdGVkRGV2aWNlKCk7CiAgICAgIGlmIChkZXZpY2UgIT0gdGhpcy5z
ZWxlY3RlZERldmljZSkgewogICAgICAgIHRoaXMuc2VsZWN0ZWREZXZpY2Ug
PSBkZXZpY2U7CiAgICAgICAgdGhpcy5taWNyb3Bob25lSW5wdXQgPSBudWxs
OwogICAgICAgIGNvbnNvbGUubG9nKCJEZXZpY2UgY2hhbmdlZCwgbWljcm9w

aG9uZUlucHV0IHJlc2V0Iik7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5t

aWNyb3Bob25lSW5wdXQpIHsKICAgICAgICBhd2FpdCB0aGlzLmluaXRNaWNy
b3Bob25lKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm1pY3JvcGhvbmVJ
bnB1dCkgewogICAgICAgIGF3YWl0IHRoaXMubWljcm9waG9uZUlucHV0LnRv
Z2dsZSgpOwogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICBzZXRUaW1l
b3V0KCgpID0+IHsKICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZ0NsaWNrID0g
ZmFsc2U7CiAgICAgIH0sIDMwMCk7CiAgICB9CiAgfSwKCiAgLy8gSW5pdGlh
bGl6ZSBzcGVlY2ggZnVuY3Rpb25hbGl0eQogIGFzeW5jIGluaXQoKSB7CiAg
ICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpOwogICAgdGhpcy5zZXR1cEJy
b3dzZXJUVFMoKTsKICAgIHRoaXMuc2V0dXBVc2VySW50ZXJhY3Rpb25IYW5k
bGluZygpOwogIH0sCgogIC8vIExvYWQgc2V0dGluZ3MgZnJvbSBzZXJ2ZXIK
ICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7CiAgICB0cnkgewogICAgICBjb25z
dCByZXNwb25zZSA9IGF3YWl0IGZldGNoQXBpKCIvc2V0dGluZ3NfZ2V0Iiwg
eyBtZXRob2Q6ICJQT1NUIiB9KTsKICAgICAgY29uc3QgZGF0YSA9IGF3YWl0
IHJlc3BvbnNlLmpzb24oKTsKICAgICAgY29uc3Qgc3BlZWNoU2VjdGlvbiA9
IGRhdGEuc2V0dGluZ3Muc2VjdGlvbnMuZmluZCgKICAgICAgICAocykgPT4g
cy50aXRsZSA9PT0gIlNwZWVjaCIKICAgICAgKTsKCiAgICAgIGlmIChzcGVl
Y2hTZWN0aW9uKSB7CiAgICAgICAgc3BlZWNoU2VjdGlvbi5maWVsZHMuZm9y
RWFjaCgoZmllbGQpID0+IHsKICAgICAgICAgIGlmICh0aGlzLmhhc093blBy
b3BlcnR5KGZpZWxkLmlkKSkgewogICAgICAgICAgICB0aGlzW2ZpZWxkLmlk
XSA9IGZpZWxkLnZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAg
ICB9CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICB3aW5kb3cudG9hc3RG
ZXRjaEVycm9yKCJGYWlsZWQgdG8gbG9hZCBzcGVlY2ggc2V0dGluZ3MiLCBl
cnJvcik7CiAgICAgIGNvbnNvbGUuZXJyb3IoIkZhaWxlZCB0byBsb2FkIHNw
ZWVjaCBzZXR0aW5nczoiLCBlcnJvcik7CiAgICB9CiAgfSwKCiAgLy8gU2V0

dXAgYnJvd3NlciBUVFMKICBzZXR1cEJyb3dzZXJUVFMoKSB7CiAgICB0aGlz
LnN5bnRoID0gd2luZG93LnNwZWVjaFN5bnRoZXNpczsKICAgIHRoaXMuYnJv
d3NlclV0dGVyYW5jZSA9IG51bGw7CiAgfSwKCiAgLy8gU2V0dXAgdXNlciBp
bnRlcmFjdGlvbiBoYW5kbGluZyBmb3IgYXV0b3BsYXkgcG9saWN5CiAgc2V0

dXBVc2VySW50ZXJhY3Rpb25IYW5kbGluZygpIHsKICAgIGNvbnN0IGVuYWJs
ZUF1ZGlvID0gKCkgPT4gewogICAgICBpZiAoIXRoaXMudXNlckhhc0ludGVy
YWN0ZWQpIHsKICAgICAgICB0aGlzLnVzZXJIYXNJbnRlcmFjdGVkID0gdHJ1
ZTsKICAgICAgICBjb25zb2xlLmxvZygiVXNlciBpbnRlcmFjdGlvbiBkZXRl
Y3RlZCAtIGF1ZGlvIHBsYXliYWNrIGVuYWJsZWQiKTsKCiAgICAgICAgLy8g
Q3JlYXRlIGEgZHVtbXkgYXVkaW8gY29udGV4dCB0byAidW5sb2NrIiBhdWRp
bwogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dCA9
IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fAogICAgICAgICAgICB3aW5k
b3cud2Via2l0QXVkaW9Db250ZXh0KSgpOwogICAgICAgICAgdGhpcy5hdWRp
b0NvbnRleHQucmVzdW1lKCk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAg
ICAgICAgY29uc29sZS5sb2coIkF1ZGlvQ29udGV4dCBub3QgYXZhaWxhYmxl
Iik7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIC8vIExpc3RlbiBm
b3IgYW55IHVzZXIgaW50ZXJhY3Rpb24KICAgIGNvbnN0IGV2ZW50cyA9IFsi
Y2xpY2siLCAidG91Y2hzdGFydCIsICJrZXlkb3duIiwgIm1vdXNlZG93biJd
OwogICAgZXZlbnRzLmZvckVhY2goKGV2ZW50KSA9PiB7CiAgICAgIGRvY3Vt
ZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGVuYWJsZUF1ZGlvLCB7CiAg
ICAgICAgb25jZTogdHJ1ZSwKICAgICAgICBwYXNzaXZlOiB0cnVlLAogICAg
ICB9KTsKICAgIH0pOwogIH0sCiAg...