aW1wb3J0IGJhc2U2NAppbXBvcnQgaGFzaGxpYgppbXBvcnQganNvbgppbXBvcnQgb3MKaW1wb3J0IHJlCmltcG9ydCBzdWJwcm9jZXNzCmZyb20gdHlwaW5nIGltcG9ydCBBbnksIExpdGVyYWwsIFR5cGVkRGljdCwgY2FzdAoKaW1wb3J0IG1vZGVscwpmcm9tIHB5dGhvbi5oZWxwZXJzIGltcG9ydCBydW50aW1lLCB3aGlzcGVyLCBkZWZlciwgZ2l0CmZyb20gLiBpbXBvcnQgZmlsZXMsIGRvdGVudgpmcm9tIHB5dGhvbi5oZWxwZXJzLnByaW50X3N0eWxlIGltcG9ydCBQcmludFN0eWxlCmZyb20gcHl0aG9uLmhlbHBlcnMucHJvdmlkZXJzIGltcG9ydCBnZXRfcHJvdmlkZXJzCmZyb20gcHl0aG9uLmhlbHBlcnMuc2VjcmV0cyBpbXBvcnQgU2VjcmV0c01hbmFnZXIKCgpjbGFzcyBTZXR0aW5ncyhUeXBlZERpY3QpOgogICAgdmVyc2lvbjogc3RyCgogICAgY2hhdF9tb2RlbF9wcm92aWRlcjogc3RyCiAgICBjaGF0X21vZGVsX25hbWU6IHN0cgogICAgY2hhdF9tb2RlbF9hcGlfYmFzZTogc3RyCiAgICBjaGF0X21vZGVsX2t3YXJnczogZGljdFtzdHIsIHN0cl0KICAgIGNoYXRfbW9kZWxfY3R4X2xlbmd0aDogaW50CiAgICBjaGF0X21vZGVsX2N0eF9oaXN0b3J5OiBmbG9hdAogICAgY2hhdF9tb2RlbF92aXNpb246IGJvb2wKICAgIGNoYXRfbW9kZWxfcmxfcmVxdWVzdHM6IGludAogICAgY2hhdF9tb2RlbF9ybF9pbnB1dDogaW50CiAgICBjaGF0X21vZGVsX3JsX291dHB1dDogaW50CgogICAgdXRpbF9tb2RlbF9wcm92aWRlcjogc3RyCiAgICB1dGlsX21vZGVsX25hbWU6IHN0cgogICAgdXRpbF9tb2RlbF9hcGlfYmFzZTogc3RyCiAgICB1dGlsX21vZGVsX2t3YXJnczogZGljdFtzdHIsIHN0cl0KICAgIHV0aWxfbW9kZWxfY3R4X2xlbmd0aDogaW50CiAgICB1dGlsX21vZGVsX2N0eF9pbnB1dDogZmxvYXQKICAgIHV0aWxfbW9kZWxfcmxfcmVxdWVzdHM6IGludAogICAgdXRpbF9tb2RlbF9ybF9pbnB1dDogaW50CiAgICB1dGlsX21vZGVsX3JsX291dHB1dDogaW50CgogICAgZW1iZWRfbW9kZWxfcHJvdmlkZXI6IHN0cgogICAgZW1iZWRfbW9kZWxfbmFtZTogc3RyCiAgICBlbWJlZF9tb2RlbF9hcGlfYmFzZTogc3RyCiAgICBlbWJlZF9tb2RlbF9rd2FyZ3M6IGRpY3Rbc3RyLCBzdHJdCiAgICBlbWJlZF9tb2RlbF9ybF9yZXF1ZXN0czogaW50CiAgICBlbWJlZF9tb2RlbF9ybF9pbnB1dDogaW50CgogICAgYnJvd3Nlcl9tb2RlbF9wcm92aWRlcjogc3RyCiAgICBicm93c2VyX21vZGVsX25hbWU6IHN0cgogICAgYnJvd3Nlcl9tb2RlbF9hcGlfYmFzZTogc3RyCiAgICBicm93c2VyX21vZGVsX3Zpc2lvbjogYm9vbAogICAgYnJvd3Nlcl9tb2RlbF9ybF9yZXF1ZXN0czogaW50CiAgICBicm93c2VyX21vZGVsX3JsX2lucHV0OiBpbnQKICAgIGJyb3dzZXJfbW9kZWxfcmxfb3V0cHV0OiBpbnQKICAgIGJyb3dzZXJfbW9kZWxfa3dhcmdzOiBkaWN0W3N0ciwgc3RyXQoKICAgIGFnZW50X3Byb2ZpbGU6IHN0cgogICAgYWdlbnRfbWVtb3J5X3N1YmRpcjogc3RyCiAgICBhZ2VudF9rbm93bGVkZ2Vfc3ViZGlyOiBzdHIKCiAgICBtZW1vcnlfcmVjYWxsX2VuYWJsZWQ6IGJvb2wKICAgIG1lbW9yeV9yZWNhbGxfZGVsYXllZDogYm9vbAogICAgbWVtb3J5X3JlY2FsbF9pbnRlcnZhbDogaW50CiAgICBtZW1vcnlfcmVjYWxsX2hpc3RvcnlfbGVuOiBpbnQKICAgIG1lbW9yeV9yZWNhbGxfbWVtb3JpZXNfbWF4X3NlYXJjaDogaW50CiAgICBtZW1vcnlfcmVjYWxsX3NvbHV0aW9uc19tYXhfc2VhcmNoOiBpbnQKICAgIG1lbW9yeV9yZWNhbGxfbWVtb3JpZXNfbWF4X3Jlc3VsdDogaW50CiAgICBtZW1vcnlfcmVjYWxsX3NvbHV0aW9uc19tYXhfcmVzdWx0OiBpbnQKICAgIG1lbW9yeV9yZWNhbGxfc2ltaWxhcml0eV90aHJlc2hvbGQ6IGZsb2F0CiAgICBtZW1vcnlfcmVjYWxsX3F1ZXJ5X3ByZXA6IGJvb2wKICAgIG1lbW9yeV9yZWNhbGxfcG9zdF9maWx0ZXI6IGJvb2wKICAgIG1lbW9yeV9tZW1vcml6ZV9lbmFibGVkOiBib29sCiAgICBtZW1vcnlfbWVtb3JpemVfY29uc29saWRhdGlvbjogYm9vbAogICAgbWVtb3J5X21lbW9yaXplX3JlcGxhY2VfdGhyZXNob2xkOiBmbG9hdAoKICAgIGFwaV9rZXlzOiBkaWN0W3N0ciwgc3RyXQoKICAgIGF1dGhfbG9naW46IHN0cgogICAgYXV0aF9wYXNzd29yZDogc3RyCiAgICByb290X3Bhc3N3b3JkOiBzdHIKCiAgICByZmNfYXV0b19kb2NrZXI6IGJvb2wKICAgIHJmY191cmw6IHN0cgogICAgcmZjX3Bhc3N3b3JkOiBzdHIKICAgIHJmY19wb3J0X2h0dHA6IGludAogICAgcmZjX3BvcnRfc3NoOiBpbnQKCiAgICBzaGVsbF9pbnRlcmZhY2U6IExpdGVyYWxbJ2xvY2FsJywnc3NoJ10KCiAgICBzdHRfbW9kZWxfc2l6ZTogc3RyCiAgICBzdHRfbGFuZ3VhZ2U6IHN0cgogICAgc3R0X3NpbGVuY2VfdGhyZXNob2xkOiBmbG9hdAogICAgc3R0X3NpbGVuY2VfZHVyYXRpb246IGludAogICAgc3R0X3dhaXRpbmdfdGltZW91dDogaW50CgogICAgdHRzX2tva29ybzogYm9vbAoKICAgIG1jcF9zZXJ2ZXJzOiBzdHIKICAgIG1jcF9jbGllbnRfaW5pdF90aW1lb3V0OiBpbnQKICAgIG1jcF9jbGllbnRfdG9vbF90aW1lb3V0OiBpbnQKICAgIG1jcF9zZXJ2ZXJfZW5hYmxlZDogYm9vbAogICAgbWNwX3NlcnZlcl90b2tlbjogc3RyCgogICAgYTJhX3NlcnZlcl9lbmFibGVkOiBib29sCgogICAgc2VjcmV0czogc3RyCgpjbGFzcyBQYXJ0aWFsU2V0dGluZ3MoU2V0dGluZ3MsIHRvdGFsPUZhbHNlKToKICAgIHBhc3MKCgpjbGFzcyBGaWVsZE9wdGlvbihUeXBlZERpY3QpOgogICAgdmFsdWU6IHN0cgogICAgbGFiZWw6IHN0cgoKCmNsYXNzIFNldHRpbmdzRmllbGQoVHlwZWREaWN0LCB0b3RhbD1GYWxzZSk6CiAgICBpZDogc3RyCiAgICB0aXRsZTogc3RyCiAgICBkZXNjcmlwdGlvbjogc3RyCiAgICB0eXBlOiBMaXRlcmFsWwogICAgICAgICJ0ZXh0IiwKICAgICAgICAibnVtYmVyIiwKICAgICAgICAic2VsZWN0IiwKICAgICAgICAicmFuZ2UiLAogICAgICAgICJ0ZXh0YXJlYSIsCiAgICAgICAgInBhc3N3b3JkIiwKICAgICAgICAic3dpdGNoIiwKICAgICAgICAiYnV0dG9uIiwKICAgICAgICAiaHRtbCIsCiAgICBdCiAgICB2YWx1ZTogQW55CiAgICBtaW46IGZsb2F0CiAgICBtYXg6IGZsb2F0CiAgICBzdGVwOiBmbG9hdAogICAgaGlkZGVuOiBib29sCiAgICBvcHRpb25zOiBsaXN0W0ZpZWxkT3B0aW9uXQogICAgc3R5bGU6IHN0cgoKCmNsYXNzIFNldHRpbmdzU2VjdGlvbihUeXBlZERpY3QsIHRvdGFsPUZhbHNlKToKICAgIGlkOiBzdHIKICAgIHRpdGxlOiBzdHIKICAgIGRlc2NyaXB0aW9uOiBzdHIKICAgIGZpZWxkczogbGlzdFtTZXR0aW5nc0ZpZWxkXQogICAgdGFiOiBzdHIgICMgSW5kaWNhdGVzIHdoaWNoIHRhYiB0aGlzIHNlY3Rpb24gYmVsb25ncyB0bwoKCmNsYXNzIFNldHRpbmdzT3V0cHV0KFR5cGVkRGljdCk6CiAgICBzZWN0aW9uczogbGlzdFtTZXR0aW5nc1NlY3Rpb25dCgoKUEFTU1dPUkRfUExBQ0VIT0xERVIgPSAiKioqKlBTV0QqKioqIgpBUElfS0VZX1BMQUNFSE9MREVSID0gIioqKioqKioqKioqKiIKClNFVFRJTkdTX0ZJTEUgPSBmaWxlcy5nZXRfYWJzX3BhdGgoInRtcC9zZXR0aW5ncy5qc29uIikKX3NldHRpbmdzOiBTZXR0aW5ncyB8IE5vbmUgPSBOb25lCgoKZGVmIGNvbnZlcnRfb3V0KHNldHRpbmdzOiBTZXR0aW5ncykgLT4gU2V0dGluZ3NPdXRwdXQ6CiAgICBkZWZhdWx0X3NldHRpbmdzID0gZ2V0X2RlZmF1bHRfc2V0dGluZ3MoKQoKICAgICMgbWFpbiBtb2RlbCBzZWN0aW9uCiAgICBjaGF0X21vZGVsX2ZpZWxkczogbGlzdFtTZXR0aW5nc0ZpZWxkXSA9IFtdCiAgICBjaGF0X21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiY2hhdF9tb2RlbF9wcm92aWRlciIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJDaGF0IG1vZGVsIHByb3ZpZGVyIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlNlbGVjdCBwcm92aWRlciBmb3IgbWFpbiBjaGF0IG1vZGVsIHVzZWQgYnkgQWdlbnQgWmVybyIsCiAgICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJjaGF0X21vZGVsX3Byb3ZpZGVyIl0sCiAgICAgICAgICAgICJvcHRpb25zIjogY2FzdChsaXN0W0ZpZWxkT3B0aW9uXSwgZ2V0X3Byb3ZpZGVycygiY2hhdCIpKSwKICAgICAgICB9CiAgICApCiAgICBjaGF0X21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiY2hhdF9tb2RlbF9uYW1lIiwKICAgICAgICAgICAgInRpdGxlIjogIkNoYXQgbW9kZWwgbmFtZSIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJFeGFjdCBuYW1lIG9mIG1vZGVsIGZyb20gc2VsZWN0ZWQgcHJvdmlkZXIiLAogICAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImNoYXRfbW9kZWxfbmFtZSJdLAogICAgICAgIH0KICAgICkKCiAgICBjaGF0X21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiY2hhdF9tb2RlbF9hcGlfYmFzZSIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJDaGF0IG1vZGVsIEFQSSBiYXNlIFVSTCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBUEkgYmFzZSBVUkwgZm9yIG1haW4gY2hhdCBtb2RlbC4gTGVhdmUgZW1wdHkgZm9yIGRlZmF1bHQuIE9ubHkgcmVsZXZhbnQgZm9yIEF6dXJlLCBsb2NhbCBhbmQgY3VzdG9tIChvdGhlcikgcHJvdmlkZXJzLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHQiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siY2hhdF9tb2RlbF9hcGlfYmFzZSJdLAogICAgICAgIH0KICAgICkKCiAgICBjaGF0X21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiY2hhdF9tb2RlbF9jdHhfbGVuZ3RoIiwKICAgICAgICAgICAgInRpdGxlIjogIkNoYXQgbW9kZWwgY29udGV4dCBsZW5ndGgiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIGluIHRoZSBjb250ZXh0IHdpbmRvdyBmb3IgTExNLiBTeXN0ZW0gcHJvbXB0LCBjaGF0IGhpc3RvcnksIFJBRyBhbmQgcmVzcG9uc2UgYWxsIGNvdW50IHRvd2FyZHMgdGhpcyBsaW1pdC4iLAogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siY2hhdF9tb2RlbF9jdHhfbGVuZ3RoIl0sCiAgICAgICAgfQogICAgKQoKICAgIGNoYXRfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJjaGF0X21vZGVsX2N0eF9oaXN0b3J5IiwKICAgICAgICAgICAgInRpdGxlIjogIkNvbnRleHQgd2luZG93IHNwYWNlIGZvciBjaGF0IGhpc3RvcnkiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiUG9ydGlvbiBvZiBjb250ZXh0IHdpbmRvdyBkZWRpY2F0ZWQgdG8gY2hhdCBoaXN0b3J5IHZpc2libGUgdG8gdGhlIGFnZW50LiBDaGF0IGhpc3Rvcnkgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIG9wdGltaXplZCB0byBmaXQuIFNtYWxsZXIgc2l6ZSB3aWxsIHJlc3VsdCBpbiBzaG9ydGVyIGFuZCBtb3JlIHN1bW1hcml6ZWQgaGlzdG9yeS4gVGhlIHJlbWFpbmluZyBzcGFjZSB3aWxsIGJlIHVzZWQgZm9yIHN5c3RlbSBwcm9tcHQsIFJBRyBhbmQgcmVzcG9uc2UuIiwKICAgICAgICAgICAgInR5cGUiOiAicmFuZ2UiLAogICAgICAgICAgICAibWluIjogMC4wMSwKICAgICAgICAgICAgIm1heCI6IDEsCiAgICAgICAgICAgICJzdGVwIjogMC4wMSwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImNoYXRfbW9kZWxfY3R4X2hpc3RvcnkiXSwKICAgICAgICB9CiAgICApCgogICAgY2hhdF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogImNoYXRfbW9kZWxfdmlzaW9uIiwKICAgICAgICAgICAgInRpdGxlIjogIlN1cHBvcnRzIFZpc2lvbiIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJNb2RlbHMgY2FwYWJsZSBvZiBWaXNpb24gY2FuIGZvciBleGFtcGxlIG5hdGl2ZWx5IHNlZSB0aGUgY29udGVudCBvZiBpbWFnZSBhdHRhY2htZW50cy4iLAogICAgICAgICAgICAidHlwZSI6ICJzd2l0Y2giLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siY2hhdF9tb2RlbF92aXNpb24iXSwKICAgICAgICB9CiAgICApCgogICAgY2hhdF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogImNoYXRfbW9kZWxfcmxfcmVxdWVzdHMiLAogICAgICAgICAgICAidGl0bGUiOiAiUmVxdWVzdHMgcGVyIG1pbnV0ZSBsaW1pdCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJMaW1pdHMgdGhlIG51bWJlciBvZiByZXF1ZXN0cyBwZXIgbWludXRlIHRvIHRoZSBjaGF0IG1vZGVsLiBXYWl0cyBpZiB0aGUgbGltaXQgaXMgZXhjZWVkZWQuIFNldCB0byAwIHRvIGRpc2FibGUgcmF0ZSBsaW1pdGluZy4iLAogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siY2hhdF9tb2RlbF9ybF9yZXF1ZXN0cyJdLAogICAgICAgIH0KICAgICkKCiAgICBjaGF0X21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiY2hhdF9tb2RlbF9ybF9pbnB1dCIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJJbnB1dCB0b2tlbnMgcGVyIG1pbnV0ZSBsaW1pdCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJMaW1pdHMgdGhlIG51bWJlciBvZiBpbnB1dCB0b2tlbnMgcGVyIG1pbnV0ZSB0byB0aGUgY2hhdCBtb2RlbC4gV2FpdHMgaWYgdGhlIGxpbWl0IGlzIGV4Y2VlZGVkLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJhdGUgbGltaXRpbmcuIiwKICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImNoYXRfbW9kZWxfcmxfaW5wdXQiXSwKICAgICAgICB9CiAgICApCgogICAgY2hhdF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogImNoYXRfbW9kZWxfcmxfb3V0cHV0IiwKICAgICAgICAgICAgInRpdGxlIjogIk91dHB1dCB0b2tlbnMgcGVyIG1pbnV0ZSBsaW1pdCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJMaW1pdHMgdGhlIG51bWJlciBvZiBvdXRwdXQgdG9rZW5zIHBlciBtaW51dGUgdG8gdGhlIGNoYXQgbW9kZWwuIFdhaXRzIGlmIHRoZSBsaW1pdCBpcyBleGNlZWRlZC4gU2V0IHRvIDAgdG8gZGlzYWJsZSByYXRlIGxpbWl0aW5nLiIsCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJjaGF0X21vZGVsX3JsX291dHB1dCJdLAogICAgICAgIH0KICAgICkKCiAgICBjaGF0X21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiY2hhdF9tb2RlbF9rd2FyZ3MiLAogICAgICAgICAgICAidGl0bGUiOiAiQ2hhdCBtb2RlbCBhZGRpdGlvbmFsIHBhcmFtZXRlcnMiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQW55IG90aGVyIHBhcmFtZXRlcnMgc3VwcG9ydGVkIGJ5IDxhIGhyZWY9J2h0dHBzOi8vZG9jcy5saXRlbGxtLmFpL2RvY3Mvc2V0X2tleXMnIHRhcmdldD0nX2JsYW5rJz5MaXRlTExNPC9hPi4gRm9ybWF0IGlzIEtFWT1WQUxVRSBvbiBpbmRpdmlkdWFsIGxpbmVzLCBqdXN0IGxpa2UgLmVudiBmaWxlLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwKICAgICAgICAgICAgInZhbHVlIjogX2RpY3RfdG9fZW52KHNldHRpbmdzWyJjaGF0X21vZGVsX2t3YXJncyJdKSwKICAgICAgICB9CiAgICApCgogICAgY2hhdF9tb2RlbF9zZWN0aW9uOiBTZXR0aW5nc1NlY3Rpb24gPSB7CiAgICAgICAgImlkIjogImNoYXRfbW9kZWwiLAogICAgICAgICJ0aXRsZSI6ICJDaGF0IE1vZGVsIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAiU2VsZWN0aW9uIGFuZCBzZXR0aW5ncyBmb3IgbWFpbiBjaGF0IG1vZGVsIHVzZWQgYnkgQWdlbnQgWmVybyIsCiAgICAgICAgImZpZWxkcyI6IGNoYXRfbW9kZWxfZmllbGRzLAogICAgICAgICJ0YWIiOiAiYWdlbnQiLAogICAgfQoKICAgICMgbWFpbiBtb2RlbCBzZWN0aW9uCiAgICB1dGlsX21vZGVsX2ZpZWxkczogbGlzdFtTZXR0aW5nc0ZpZWxkXSA9IFtdCiAgICB1dGlsX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAidXRpbF9tb2RlbF9wcm92aWRlciIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJVdGlsaXR5IG1vZGVsIHByb3ZpZGVyIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlNlbGVjdCBwcm92aWRlciBmb3IgdXRpbGl0eSBtb2RlbCB1c2VkIGJ5IHRoZSBmcmFtZXdvcmsiLAogICAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1sidXRpbF9tb2RlbF9wcm92aWRlciJdLAogICAgICAgICAgICAib3B0aW9ucyI6IGNhc3QobGlzdFtGaWVsZE9wdGlvbl0sIGdldF9wcm92aWRlcnMoImNoYXQiKSksCiAgICAgICAgfQogICAgKQogICAgdXRpbF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogInV0aWxfbW9kZWxfbmFtZSIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJVdGlsaXR5IG1vZGVsIG5hbWUiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiRXhhY3QgbmFtZSBvZiBtb2RlbCBmcm9tIHNlbGVjdGVkIHByb3ZpZGVyIiwKICAgICAgICAgICAgInR5cGUiOiAidGV4dCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJ1dGlsX21vZGVsX25hbWUiXSwKICAgICAgICB9CiAgICApCgogICAgdXRpbF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogInV0aWxfbW9kZWxfYXBpX2Jhc2UiLAogICAgICAgICAgICAidGl0bGUiOiAiVXRpbGl0eSBtb2RlbCBBUEkgYmFzZSBVUkwiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQVBJIGJhc2UgVVJMIGZvciB1dGlsaXR5IG1vZGVsLiBMZWF2ZSBlbXB0eSBmb3IgZGVmYXVsdC4gT25seSByZWxldmFudCBmb3IgQXp1cmUsIGxvY2FsIGFuZCBjdXN0b20gKG90aGVyKSBwcm92aWRlcnMuIiwKICAgICAgICAgICAgInR5cGUiOiAidGV4dCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJ1dGlsX21vZGVsX2FwaV9iYXNlIl0sCiAgICAgICAgfQogICAgKQoKICAgIHV0aWxfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJ1dGlsX21vZGVsX3JsX3JlcXVlc3RzIiwKICAgICAgICAgICAgInRpdGxlIjogIlJlcXVlc3RzIHBlciBtaW51dGUgbGltaXQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTGltaXRzIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMgcGVyIG1pbnV0ZSB0byB0aGUgdXRpbGl0eSBtb2RlbC4gV2FpdHMgaWYgdGhlIGxpbWl0IGlzIGV4Y2VlZGVkLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJhdGUgbGltaXRpbmcuIiwKICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbInV0aWxfbW9kZWxfcmxfcmVxdWVzdHMiXSwKICAgICAgICB9CiAgICApCgogICAgdXRpbF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogInV0aWxfbW9kZWxfcmxfaW5wdXQiLAogICAgICAgICAgICAidGl0bGUiOiAiSW5wdXQgdG9rZW5zIHBlciBtaW51dGUgbGltaXQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTGltaXRzIHRoZSBudW1iZXIgb2YgaW5wdXQgdG9rZW5zIHBlciBtaW51dGUgdG8gdGhlIHV0aWxpdHkgbW9kZWwuIFdhaXRzIGlmIHRoZSBsaW1pdCBpcyBleGNlZWRlZC4gU2V0IHRvIDAgdG8gZGlzYWJsZSByYXRlIGxpbWl0aW5nLiIsCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJ1dGlsX21vZGVsX3JsX2lucHV0Il0sCiAgICAgICAgfQogICAgKQoKICAgIHV0aWxfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJ1dGlsX21vZGVsX3JsX291dHB1dCIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJPdXRwdXQgdG9rZW5zIHBlciBtaW51dGUgbGltaXQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTGltaXRzIHRoZSBudW1iZXIgb2Ygb3V0cHV0IHRva2VucyBwZXIgbWludXRlIHRvIHRoZSB1dGlsaXR5IG1vZGVsLiBXYWl0cyBpZiB0aGUgbGltaXQgaXMgZXhjZWVkZWQuIFNldCB0byAwIHRvIGRpc2FibGUgcmF0ZSBsaW1pdGluZy4iLAogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1sidXRpbF9tb2RlbF9ybF9vdXRwdXQiXSwKICAgICAgICB9CiAgICApCgogICAgdXRpbF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogInV0aWxfbW9kZWxfa3dhcmdzIiwKICAgICAgICAgICAgInRpdGxlIjogIlV0aWxpdHkgbW9kZWwgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkFueSBvdGhlciBwYXJhbWV0ZXJzIHN1cHBvcnRlZCBieSA8YSBocmVmPSdodHRwczovL2RvY3MubGl0ZWxsbS5haS9kb2NzL3NldF9rZXlzJyB0YXJnZXQ9J19ibGFuayc+TGl0ZUxMTTwvYT4uIEZvcm1hdCBpcyBLRVk9VkFMVUUgb24gaW5kaXZpZHVhbCBsaW5lcywganVzdCBsaWtlIC5lbnYgZmlsZS4iLAogICAgICAgICAgICAidHlwZSI6ICJ0ZXh0YXJlYSIsCiAgICAgICAgICAgICJ2YWx1ZSI6IF9kaWN0X3RvX2VudihzZXR0aW5nc1sidXRpbF9tb2RlbF9rd2FyZ3MiXSksCiAgICAgICAgfQogICAgKQoKICAgIHV0aWxfbW9kZWxfc2VjdGlvbjogU2V0dGluZ3NTZWN0aW9uID0gewogICAgICAgICJpZCI6ICJ1dGlsX21vZGVsIiwKICAgICAgICAidGl0bGUiOiAiVXRpbGl0eSBtb2RlbCIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogIlNtYWxsZXIsIGNoZWFwZXIsIGZhc3RlciBtb2RlbCBmb3IgaGFuZGxpbmcgdXRpbGl0eSB0YXNrcyBsaWtlIG9yZ2FuaXppbmcgbWVtb3J5LCBwcmVwYXJpbmcgcHJvbXB0cywgc3VtbWFyaXppbmcuIiwKICAgICAgICAiZmllbGRzIjogdXRpbF9tb2RlbF9maWVsZHMsCiAgICAgICAgInRhYiI6ICJhZ2VudCIsCiAgICB9CgogICAgIyBlbWJlZGRpbmcgbW9kZWwgc2VjdGlvbgogICAgZW1iZWRfbW9kZWxfZmllbGRzOiBsaXN0W1NldHRpbmdzRmllbGRdID0gW10KICAgIGVtYmVkX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiZW1iZWRfbW9kZWxfcHJvdmlkZXIiLAogICAgICAgICAgICAidGl0bGUiOiAiRW1iZWRkaW5nIG1vZGVsIHByb3ZpZGVyIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlNlbGVjdCBwcm92aWRlciBmb3IgZW1iZWRkaW5nIG1vZGVsIHVzZWQgYnkgdGhlIGZyYW1ld29yayIsCiAgICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJlbWJlZF9tb2RlbF9wcm92aWRlciJdLAogICAgICAgICAgICAib3B0aW9ucyI6IGNhc3QobGlzdFtGaWVsZE9wdGlvbl0sIGdldF9wcm92aWRlcnMoImVtYmVkZGluZyIpKSwKICAgICAgICB9CiAgICApCiAgICBlbWJlZF9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogImVtYmVkX21vZGVsX25hbWUiLAogICAgICAgICAgICAidGl0bGUiOiAiRW1iZWRkaW5nIG1vZGVsIG5hbWUiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiRXhhY3QgbmFtZSBvZiBtb2RlbCBmcm9tIHNlbGVjdGVkIHByb3ZpZGVyIiwKICAgICAgICAgICAgInR5cGUiOiAidGV4dCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJlbWJlZF9tb2RlbF9uYW1lIl0sCiAgICAgICAgfQogICAgKQoKICAgIGVtYmVkX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiZW1iZWRfbW9kZWxfYXBpX2Jhc2UiLAogICAgICAgICAgICAidGl0bGUiOiAiRW1iZWRkaW5nIG1vZGVsIEFQSSBiYXNlIFVSTCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBUEkgYmFzZSBVUkwgZm9yIGVtYmVkZGluZyBtb2RlbC4gTGVhdmUgZW1wdHkgZm9yIGRlZmF1bHQuIE9ubHkgcmVsZXZhbnQgZm9yIEF6dXJlLCBsb2NhbCBhbmQgY3VzdG9tIChvdGhlcikgcHJvdmlkZXJzLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHQiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siZW1iZWRfbW9kZWxfYXBpX2Jhc2UiXSwKICAgICAgICB9CiAgICApCgogICAgZW1iZWRfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJlbWJlZF9tb2RlbF9ybF9yZXF1ZXN0cyIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJSZXF1ZXN0cyBwZXIgbWludXRlIGxpbWl0IiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkxpbWl0cyB0aGUgbnVtYmVyIG9mIHJlcXVlc3RzIHBlciBtaW51dGUgdG8gdGhlIGVtYmVkZGluZyBtb2RlbC4gV2FpdHMgaWYgdGhlIGxpbWl0IGlzIGV4Y2VlZGVkLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJhdGUgbGltaXRpbmcuIiwKICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImVtYmVkX21vZGVsX3JsX3JlcXVlc3RzIl0sCiAgICAgICAgfQogICAgKQoKICAgIGVtYmVkX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiZW1iZWRfbW9kZWxfcmxfaW5wdXQiLAogICAgICAgICAgICAidGl0bGUiOiAiSW5wdXQgdG9rZW5zIHBlciBtaW51dGUgbGltaXQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiTGltaXRzIHRoZSBudW1iZXIgb2YgaW5wdXQgdG9rZW5zIHBlciBtaW51dGUgdG8gdGhlIGVtYmVkZGluZyBtb2RlbC4gV2FpdHMgaWYgdGhlIGxpbWl0IGlzIGV4Y2VlZGVkLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJhdGUgbGltaXRpbmcuIiwKICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImVtYmVkX21vZGVsX3JsX2lucHV0Il0sCiAgICAgICAgfQogICAgKQoKICAgIGVtYmVkX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiZW1iZWRfbW9kZWxfa3dhcmdzIiwKICAgICAgICAgICAgInRpdGxlIjogIkVtYmVkZGluZyBtb2RlbCBhZGRpdGlvbmFsIHBhcmFtZXRlcnMiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQW55IG90aGVyIHBhcmFtZXRlcnMgc3VwcG9ydGVkIGJ5IDxhIGhyZWY9J2h0dHBzOi8vZG9jcy5saXRlbGxtLmFpL2RvY3Mvc2V0X2tleXMnIHRhcmdldD0nX2JsYW5rJz5MaXRlTExNPC9hPi4gRm9ybWF0IGlzIEtFWT1WQUxVRSBvbiBpbmRpdmlkdWFsIGxpbmVzLCBqdXN0IGxpa2UgLmVudiBmaWxlLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwKICAgICAgICAgICAgInZhbHVlIjogX2RpY3RfdG9fZW52KHNldHRpbmdzWyJlbWJlZF9tb2RlbF9rd2FyZ3MiXSksCiAgICAgICAgfQogICAgKQoKICAgIGVtYmVkX21vZGVsX3NlY3Rpb246IFNldHRpbmdzU2VjdGlvbiA9IHsKICAgICAgICAiaWQiOiAiZW1iZWRfbW9kZWwiLAogICAgICAgICJ0aXRsZSI6ICJFbWJlZGRpbmcgTW9kZWwiLAogICAgICAgICJkZXNjcmlwdGlvbiI6IGYiU2V0dGluZ3MgZm9yIHRoZSBlbWJlZGRpbmcgbW9kZWwgdXNlZCBieSBBZ2VudCBaZXJvLjxicj48aDQ+4pqg77iPIE5vIG5lZWQgdG8gY2hhbmdlPC9oND5UaGUgZGVmYXVsdCBIdWdnaW5nRmFjZSBtb2RlbCB7ZGVmYXVsdF9zZXR0aW5nc1snZW1iZWRfbW9kZWxfbmFtZSddfSBpcyBwcmVsb2FkZWQgYW5kIHJ1bnMgbG9jYWxseSB3aXRoaW4gdGhlIGRvY2tlciBjb250YWluZXIgYW5kIHRoZXJlJ3Mgbm8gbmVlZCB0byBjaGFuZ2UgaXQgdW5sZXNzIHlvdSBoYXZlIGEgc3BlY2lmaWMgcmVxdWlyZW1lbnRzIGZvciBlbWJlZGRpbmcuIiwKICAgICAgICAiZmllbGRzIjogZW1iZWRfbW9kZWxfZmllbGRzLAogICAgICAgICJ0YWIiOiAiYWdlbnQiLAogICAgfQoKICAgICMgZW1iZWRkaW5nIG1vZGVsIHNlY3Rpb24KICAgIGJyb3dzZXJfbW9kZWxfZmllbGRzOiBsaXN0W1NldHRpbmdzRmllbGRdID0gW10KICAgIGJyb3dzZXJfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJicm93c2VyX21vZGVsX3Byb3ZpZGVyIiwKICAgICAgICAgICAgInRpdGxlIjogIldlYiBCcm93c2VyIG1vZGVsIHByb3ZpZGVyIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlNlbGVjdCBwcm92aWRlciBmb3Igd2ViIGJyb3dzZXIgbW9kZWwgdXNlZCBieSA8YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vYnJvd3Nlci11c2UvYnJvd3Nlci11c2UnIHRhcmdldD0nX2JsYW5rJz5icm93c2VyLXVzZTwvYT4gZnJhbWV3b3JrIiwKICAgICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImJyb3dzZXJfbW9kZWxfcHJvdmlkZXIiXSwKICAgICAgICAgICAgIm9wdGlvbnMiOiBjYXN0KGxpc3RbRmllbGRPcHRpb25dLCBnZXRfcHJvdmlkZXJzKCJjaGF0IikpLAogICAgICAgIH0KICAgICkKICAgIGJyb3dzZXJfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJicm93c2VyX21vZGVsX25hbWUiLAogICAgICAgICAgICAidGl0bGUiOiAiV2ViIEJyb3dzZXIgbW9kZWwgbmFtZSIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJFeGFjdCBuYW1lIG9mIG1vZGVsIGZyb20gc2VsZWN0ZWQgcHJvdmlkZXIiLAogICAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImJyb3dzZXJfbW9kZWxfbmFtZSJdLAogICAgICAgIH0KICAgICkKCiAgICBicm93c2VyX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiYnJvd3Nlcl9tb2RlbF9hcGlfYmFzZSIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJXZWIgQnJvd3NlciBtb2RlbCBBUEkgYmFzZSBVUkwiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQVBJIGJhc2UgVVJMIGZvciB3ZWIgYnJvd3NlciBtb2RlbC4gTGVhdmUgZW1wdHkgZm9yIGRlZmF1bHQuIE9ubHkgcmVsZXZhbnQgZm9yIEF6dXJlLCBsb2NhbCBhbmQgY3VzdG9tIChvdGhlcikgcHJvdmlkZXJzLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHQiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siYnJvd3Nlcl9tb2RlbF9hcGlfYmFzZSJdLAogICAgICAgIH0KICAgICkKCiAgICBicm93c2VyX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiYnJvd3Nlcl9tb2RlbF92aXNpb24iLAogICAgICAgICAgICAidGl0bGUiOiAiVXNlIFZpc2lvbiIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJNb2RlbHMgY2FwYWJsZSBvZiBWaXNpb24gY2FuIHVzZSBpdCB0byBhbmFseXplIHdlYiBwYWdlcyBmcm9tIHNjcmVlbnNob3RzLiBJbmNyZWFzZXMgcXVhbGl0eSBidXQgYWxzbyB0b2tlbiB1c2FnZS4iLAogICAgICAgICAgICAidHlwZSI6ICJzd2l0Y2giLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siYnJvd3Nlcl9tb2RlbF92aXNpb24iXSwKICAgICAgICB9CiAgICApCgogICAgYnJvd3Nlcl9tb2RlbF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogImJyb3dzZXJfbW9kZWxfcmxfcmVxdWVzdHMiLAogICAgICAgICAgICAidGl0bGUiOiAiV2ViIEJyb3dzZXIgbW9kZWwgcmF0ZSBsaW1pdCByZXF1ZXN0cyIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJSYXRlIGxpbWl0IHJlcXVlc3RzIGZvciB3ZWIgYnJvd3NlciBtb2RlbC4iLAogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siYnJvd3Nlcl9tb2RlbF9ybF9yZXF1ZXN0cyJdLAogICAgICAgIH0KICAgICkKCiAgICBicm93c2VyX21vZGVsX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiYnJvd3Nlcl9tb2RlbF9ybF9pbnB1dCIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJXZWIgQnJvd3NlciBtb2RlbCByYXRlIGxpbWl0IGlucHV0IiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlJhdGUgbGltaXQgaW5wdXQgZm9yIHdlYiBicm93c2VyIG1vZGVsLiIsCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJicm93c2VyX21vZGVsX3JsX2lucHV0Il0sCiAgICAgICAgfQogICAgKQoKICAgIGJyb3dzZXJfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJicm93c2VyX21vZGVsX3JsX291dHB1dCIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJXZWIgQnJvd3NlciBtb2RlbCByYXRlIGxpbWl0IG91dHB1dCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJSYXRlIGxpbWl0IG91dHB1dCBmb3Igd2ViIGJyb3dzZXIgbW9kZWwuIiwKICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImJyb3dzZXJfbW9kZWxfcmxfb3V0cHV0Il0sCiAgICAgICAgfQogICAgKQoKICAgIGJyb3dzZXJfbW9kZWxfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJicm93c2VyX21vZGVsX2t3YXJncyIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJXZWIgQnJvd3NlciBtb2RlbCBhZGRpdGlvbmFsIHBhcmFtZXRlcnMiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQW55IG90aGVyIHBhcmFtZXRlcnMgc3VwcG9ydGVkIGJ5IDxhIGhyZWY9J2h0dHBzOi8vZG9jcy5saXRlbGxtLmFpL2RvY3Mvc2V0X2tleXMnIHRhcmdldD0nX2JsYW5rJz5MaXRlTExNPC9hPi4gRm9ybWF0IGlzIEtFWT1WQUxVRSBvbiBpbmRpdmlkdWFsIGxpbmVzLCBqdXN0IGxpa2UgLmVudiBmaWxlLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwKICAgICAgICAgICAgInZhbHVlIjogX2RpY3RfdG9fZW52KHNldHRpbmdzWyJicm93c2VyX21vZGVsX2t3YXJncyJdKSwKICAgICAgICB9CiAgICApCgogICAgYnJvd3Nlcl9tb2RlbF9zZWN0aW9uOiBTZXR0aW5nc1NlY3Rpb24gPSB7CiAgICAgICAgImlkIjogImJyb3dzZXJfbW9kZWwiLAogICAgICAgICJ0aXRsZSI6ICJXZWIgQnJvd3NlciBNb2RlbCIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogIlNldHRpbmdzIGZvciB0aGUgd2ViIGJyb3dzZXIgbW9kZWwuIEFnZW50IFplcm8gdXNlcyA8YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vYnJvd3Nlci11c2UvYnJvd3Nlci11c2UnIHRhcmdldD0nX2JsYW5rJz5icm93c2VyLXVzZTwvYT4gYWdlbnRpYyBmcmFtZXdvcmsgdG8gaGFuZGxlIHdlYiBpbnRlcmFjdGlvbnMuIiwKICAgICAgICAiZmllbGRzIjogYnJvd3Nlcl9tb2RlbF9maWVsZHMsCiAgICAgICAgInRhYiI6ICJhZ2VudCIsCiAgICB9CgogICAgIyBiYXNpYyBhdXRoIHNlY3Rpb24KICAgIGF1dGhfZmllbGRzOiBsaXN0W1NldHRpbmdzRmllbGRdID0gW10KCiAgICBhdXRoX2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAiYXV0aF9sb2dpbiIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJVSSBMb2dpbiIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJTZXQgdXNlciBuYW1lIGZvciB3ZWIgVUkiLAogICAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwKICAgICAgICAgICAgInZhbHVlIjogZG90ZW52LmdldF9kb3RlbnZfdmFsdWUoZG90ZW52LktFWV9BVVRIX0xPR0lOKSBvciAiIiwKICAgICAgICB9CiAgICApCgogICAgYXV0aF9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogImF1dGhfcGFzc3dvcmQiLAogICAgICAgICAgICAidGl0bGUiOiAiVUkgUGFzc3dvcmQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiU2V0IHVzZXIgcGFzc3dvcmQgZm9yIHdlYiBVSSIsCiAgICAgICAgICAgICJ0eXBlIjogInBhc3N3b3JkIiwKICAgICAgICAgICAgInZhbHVlIjogKAogICAgICAgICAgICAgICAgUEFTU1dPUkRfUExBQ0VIT0xERVIKICAgICAgICAgICAgICAgIGlmIGRvdGVudi5nZXRfZG90ZW52X3ZhbHVlKGRvdGVudi5LRVlfQVVUSF9QQVNTV09SRCkKICAgICAgICAgICAgICAgIGVsc2UgIiIKICAgICAgICAgICAgKSwKICAgICAgICB9CiAgICApCgogICAgaWYgcnVudGltZS5pc19kb2NrZXJpemVkKCk6CiAgICAgICAgYXV0aF9maWVsZHMuYXBwZW5kKAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiaWQiOiAicm9vdF9wYXNzd29yZCIsCiAgICAgICAgICAgICAgICAidGl0bGUiOiAicm9vdCBQYXNzd29yZCIsCiAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQ2hhbmdlIGxpbnV4IHJvb3QgcGFzc3dvcmQgaW4gZG9ja2VyIGNvbnRhaW5lci4gVGhpcyBwYXNzd29yZCBjYW4gYmUgdXNlZCBmb3IgU1NIIGFjY2Vzcy4gT3JpZ2luYWwgcGFzc3dvcmQgd2FzIHJhbmRvbWx5IGdlbmVyYXRlZCBkdXJpbmcgc2V0dXAuIiwKICAgICAgICAgICAgICAgICJ0eXBlIjogInBhc3N3b3JkIiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIiLAogICAgICAgICAgICB9CiAgICAgICAgKQoKICAgIGF1dGhfc2VjdGlvbjogU2V0dGluZ3NTZWN0aW9uID0gewogICAgICAgICJpZCI6ICJhdXRoIiwKICAgICAgICAidGl0bGUiOiAiQXV0aGVudGljYXRpb24iLAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJTZXR0aW5ncyBmb3IgYXV0aGVudGljYXRpb24gdG8gdXNlIEFnZW50IFplcm8gV2ViIFVJLiIsCiAgICAgICAgImZpZWxkcyI6IGF1dGhfZmllbGRzLAogICAgICAgICJ0YWIiOiAiZXh0ZXJuYWwiLAogICAgfQoKICAgICMgYXBpIGtleXMgbW9kZWwgc2VjdGlvbgogICAgYXBpX2tleXNfZmllbGRzOiBsaXN0W1NldHRpbmdzRmllbGRdID0gW10KCiAgICAjIENvbGxlY3QgdW5pcXVlIHByb3ZpZGVycyBmcm9tIGJvdGggY2hhdCBhbmQgZW1iZWRkaW5nIHNlY3Rpb25zCiAgICBwcm92aWRlcnNfc2Vlbjogc2V0W3N0cl0gPSBzZXQoKQogICAgZm9yIHBfdHlwZSBpbiAoImNoYXQiLCAiZW1iZWRkaW5nIik6CiAgICAgICAgZm9yIHByb3ZpZGVyIGluIGdldF9wcm92aWRlcnMocF90eXBlKToKICAgICAgICAgICAgcGlkX2xvd2VyID0gcHJvdmlkZXJbInZhbHVlIl0ubG93ZXIoKQogICAgICAgICAgICBpZiBwaWRfbG93ZXIgaW4gcHJvdmlkZXJzX3NlZW46CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBwcm92aWRlcnNfc2Vlbi5hZGQocGlkX2xvd2VyKQogICAgICAgICAgICBhcGlfa2V5c19maWVsZHMuYXBwZW5kKAogICAgICAgICAgICAgICAgX2dldF9hcGlfa2V5X2ZpZWxkKHNldHRpbmdzLCBwaWRfbG93ZXIsIHByb3ZpZGVyWyJsYWJlbCJdKQogICAgICAgICAgICApCgogICAgYXBpX2tleXNfc2VjdGlvbjogU2V0dGluZ3NTZWN0aW9uID0gewogICAgICAgICJpZCI6ICJhcGlfa2V5cyIsCiAgICAgICAgInRpdGxlIjogIkFQSSBLZXlzIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAiQVBJIGtleXMgZm9yIG1vZGVsIHByb3ZpZGVycyBhbmQgc2VydmljZXMgdXNlZCBieSBBZ2VudCBaZXJvLiBZb3UgY2FuIHNldCBtdWx0aXBsZSBBUEkga2V5cyBzZXBhcmF0ZWQgYnkgYSBjb21tYSAoLCkuIFRoZXkgd2lsbCBiZSB1c2VkIGluIHJvdW5kLXJvYmluIGZhc2hpb24uIiwKICAgICAgICAiZmllbGRzIjogYXBpX2tleXNfZmllbGRzLAogICAgICAgICJ0YWIiOiAiZXh0ZXJuYWwiLAogICAgfQoKICAgICMgQWdlbnQgY29uZmlnIHNlY3Rpb24KICAgIGFnZW50X2ZpZWxkczogbGlzdFtTZXR0aW5nc0ZpZWxkXSA9IFtdCgogICAgYWdlbnRfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJhZ2VudF9wcm9maWxlIiwKICAgICAgICAgICAgInRpdGxlIjogIkRlZmF1bHQgYWdlbnQgcHJvZmlsZSIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJTdWJkaXJlY3Rvcnkgb2YgL2FnZW50cyBmb2xkZXIgdG8gYmUgdXNlZCBieSBkZWZhdWx0IGFnZW50IG5vLiAwLiBTdWJvcmRpbmF0ZSBhZ2VudHMgY2FuIGJlIHNwYXduZWQgd2l0aCBvdGhlciBwcm9maWxlcywgdGhhdCBpcyBvbiB0aGVpciBzdXBlcmlvciBhZ2VudCB0byBkZWNpZGUuIFRoaXMgc2V0dGluZyBhZmZlY3RzIHRoZSBiZWhhdmlvdXIgb2YgdGhlIHRvcCBsZXZlbCBhZ2VudCB5b3UgY29tbXVuaWNhdGUgd2l0aC4iLAogICAgICAgICAgICAidHlwZSI6ICJzZWxlY3QiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siYWdlbnRfcHJvZmlsZSJdLAogICAgICAgICAgICAib3B0aW9ucyI6IFsKICAgICAgICAgICAgICAgIHsidmFsdWUiOiBzdWJkaXIsICJsYWJlbCI6IHN1YmRpcn0KICAgICAgICAgICAgICAgIGZvciBzdWJkaXIgaW4gZmlsZXMuZ2V0X3N1YmRpcmVjdG9yaWVzKCJhZ2VudHMiKQogICAgICAgICAgICAgICAgaWYgc3ViZGlyICE9ICJfZXhhbXBsZSIKICAgICAgICAgICAgXSwKICAgICAgICB9CiAgICApCgogICAgYWdlbnRfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJhZ2VudF9rbm93bGVkZ2Vfc3ViZGlyIiwKICAgICAgICAgICAgInRpdGxlIjogIktub3dsZWRnZSBzdWJkaXJlY3RvcnkiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiU3ViZGlyZWN0b3J5IG9mIC9rbm93bGVkZ2UgZm9sZGVyIHRvIHVzZSBmb3IgYWdlbnQga25vd2xlZGdlIGltcG9ydC4gJ2RlZmF1bHQnIHN1YmZvbGRlciBpcyBhbHdheXMgaW1wb3J0ZWQgYW5kIGNvbnRhaW5zIGZyYW1ld29yayBrbm93bGVkZ2UuIiwKICAgICAgICAgICAgInR5cGUiOiAic2VsZWN0IiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbImFnZW50X2tub3dsZWRnZV9zdWJkaXIiXSwKICAgICAgICAgICAgIm9wdGlvbnMiOiBbCiAgICAgICAgICAgICAgICB7InZhbHVlIjogc3ViZGlyLCAibGFiZWwiOiBzdWJkaXJ9CiAgICAgICAgICAgICAgICBmb3Igc3ViZGlyIGluIGZpbGVzLmdldF9zdWJkaXJlY3Rvcmllcygia25vd2xlZGdlIiwgZXhjbHVkZT0iZGVmYXVsdCIpCiAgICAgICAgICAgIF0sCiAgICAgICAgfQogICAgKQoKICAgIGFnZW50X3NlY3Rpb246IFNldHRpbmdzU2VjdGlvbiA9IHsKICAgICAgICAiaWQiOiAiYWdlbnQiLAogICAgICAgICJ0aXRsZSI6ICJBZ2VudCBDb25maWciLAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJBZ2VudCBwYXJhbWV0ZXJzLiIsCiAgICAgICAgImZpZWxkcyI6IGFnZW50X2ZpZWxkcywKICAgICAgICAidGFiIjogImFnZW50IiwKICAgIH0KCiAgICBtZW1vcnlfZmllbGRzOiBsaXN0W1NldHRpbmdzRmllbGRdID0gW10KCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJhZ2VudF9tZW1vcnlfc3ViZGlyIiwKICAgICAgICAgICAgInRpdGxlIjogIk1lbW9yeSBTdWJkaXJlY3RvcnkiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiU3ViZGlyZWN0b3J5IG9mIC9tZW1vcnkgZm9sZGVyIHRvIHVzZSBmb3IgYWdlbnQgbWVtb3J5IHN0b3JhZ2UuIFVzZWQgdG8gc2VwYXJhdGUgbWVtb3J5IHN0b3JhZ2UgYmV0d2VlbiBkaWZmZXJlbnQgaW5zdGFuY2VzLiIsCiAgICAgICAgICAgICJ0eXBlIjogInRleHQiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1siYWdlbnRfbWVtb3J5X3N1YmRpciJdLAogICAgICAgICAgICAjICJvcHRpb25zIjogWwogICAgICAgICAgICAjICAgICB7InZhbHVlIjogc3ViZGlyLCAibGFiZWwiOiBzdWJkaXJ9CiAgICAgICAgICAgICMgICAgIGZvciBzdWJkaXIgaW4gZmlsZXMuZ2V0X3N1YmRpcmVjdG9yaWVzKCJtZW1vcnkiLCBleGNsdWRlPSJlbWJlZGRpbmdzIikKICAgICAgICAgICAgIyBdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX2VuYWJsZWQiLAogICAgICAgICAgICAidGl0bGUiOiAiTWVtb3J5IGF1dG8tcmVjYWxsIGVuYWJsZWQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQWdlbnQgWmVybyB3aWxsIGF1dG9tYXRpY2FsbHkgcmVjYWxsIG1lbW9yaWVzIGJhc2VkIG9uIGNvbnZlc2F0aW9uIGNvbnRleHQuIiwKICAgICAgICAgICAgInR5cGUiOiAic3dpdGNoIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbIm1lbW9yeV9yZWNhbGxfZW5hYmxlZCJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX2RlbGF5ZWQiLAogICAgICAgICAgICAidGl0bGUiOiAiTWVtb3J5IGF1dG8tcmVjYWxsIGRlbGF5ZWQiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGhlIGFnZW50IHdpbGwgbm90IHdhaXQgZm9yIGF1dG8gbWVtb3J5IHJlY2FsbC4gTWVtb3JpZXMgd2lsbCBiZSBkZWxpdmVyZWQgb25lIG1lc3NhZ2UgbGF0ZXIuIFRoaXMgc3BlZWRzIHVwIGFnZW50J3MgcmVzcG9uc2UgdGltZSBidXQgbWF5IHJlc3VsdCBpbiBsZXNzIHJlbGV2YW50IGZpcnN0IHN0ZXAuIiwKICAgICAgICAgICAgInR5cGUiOiAic3dpdGNoIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbIm1lbW9yeV9yZWNhbGxfZGVsYXllZCJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX3F1ZXJ5X3ByZXAiLAogICAgICAgICAgICAidGl0bGUiOiAiQXV0by1yZWNhbGwgQUkgcXVlcnkgcHJlcGFyYXRpb24iLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiRW5hYmxlcyB2ZWN0b3IgREIgcXVlcnkgcHJlcGFyYXRpb24gZnJvbSBjb252ZXJzYXRpb24gY29udGV4dCBieSB1dGlsaXR5IExMTSBmb3IgYXV0by1yZWNhbGwuIEltcHJvdmVzIHNlYXJjaCBxdWFsaXR5LCBhZGRzIDEgdXRpbGl0eSBMTE0gY2FsbCBwZXIgYXV0by1yZWNhbGwuIiwKICAgICAgICAgICAgInR5cGUiOiAic3dpdGNoIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbIm1lbW9yeV9yZWNhbGxfcXVlcnlfcHJlcCJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX3Bvc3RfZmlsdGVyIiwKICAgICAgICAgICAgInRpdGxlIjogIkF1dG8tcmVjYWxsIEFJIHBvc3QtZmlsdGVyaW5nIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkVuYWJsZXMgbWVtb3J5IHJlbGV2YW5jZSBmaWx0ZXJpbmcgYnkgdXRpbGl0eSBMTE0gZm9yIGF1dG8tcmVjYWxsLiBJbXByb3ZlcyBzZWFyY2ggcXVhbGl0eSwgYWRkcyAxIHV0aWxpdHkgTExNIGNhbGwgcGVyIGF1dG8tcmVjYWxsLiIsCiAgICAgICAgICAgICJ0eXBlIjogInN3aXRjaCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJtZW1vcnlfcmVjYWxsX3Bvc3RfZmlsdGVyIl0sCiAgICAgICAgfQogICAgKQoKICAgIG1lbW9yeV9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogIm1lbW9yeV9yZWNhbGxfaW50ZXJ2YWwiLAogICAgICAgICAgICAidGl0bGUiOiAiTWVtb3J5IGF1dG8tcmVjYWxsIGludGVydmFsIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIk1lbW9yaWVzIGFyZSByZWNhbGxlZCBhZnRlciBldmVyeSB1c2VyIG9yIHN1cGVyaW9yIGFnZW50IG1lc3NhZ2UuIER1cmluZyBhZ2VudCdzIG1vbm9sb2d1ZSwgbWVtb3JpZXMgYXJlIHJlY2FsbGVkIGV2ZXJ5IFggdHVybnMgYmFzZWQgb24gdGhpcyBwYXJhbWV0ZXIuIiwKICAgICAgICAgICAgInR5cGUiOiAicmFuZ2UiLAogICAgICAgICAgICAibWluIjogMSwKICAgICAgICAgICAgIm1heCI6IDEwLAogICAgICAgICAgICAic3RlcCI6IDEsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJtZW1vcnlfcmVjYWxsX2ludGVydmFsIl0sCiAgICAgICAgfQogICAgKQoKICAgIG1lbW9yeV9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogIm1lbW9yeV9yZWNhbGxfaGlzdG9yeV9sZW4iLAogICAgICAgICAgICAidGl0bGUiOiAiTWVtb3J5IGF1dG8tcmVjYWxsIGhpc3RvcnkgbGVuZ3RoIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBsZW5ndGggb2YgY29udmVyc2F0aW9uIGhpc3RvcnkgcGFzc2VkIHRvIG1lbW9yeSByZWNhbGwgTExNIGZvciBjb250ZXh0IChpbiBjaGFyYWN0ZXJzKS4iLAogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1sibWVtb3J5X3JlY2FsbF9oaXN0b3J5X2xlbiJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX3NpbWlsYXJpdHlfdGhyZXNob2xkIiwKICAgICAgICAgICAgInRpdGxlIjogIk1lbW9yeSBhdXRvLXJlY2FsbCBzaW1pbGFyaXR5IHRocmVzaG9sZCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgdGhyZXNob2xkIGZvciBzaW1pbGFyaXR5IHNlYXJjaCBpbiBtZW1vcnkgcmVjYWxsICgwID0gbm8gc2ltaWxhcml0eSwgMSA9IGV4YWN0IG1hdGNoKS4iLAogICAgICAgICAgICAidHlwZSI6ICJyYW5nZSIsCiAgICAgICAgICAgICJtaW4iOiAwLAogICAgICAgICAgICAibWF4IjogMSwKICAgICAgICAgICAgInN0ZXAiOiAwLjAxLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1sibWVtb3J5X3JlY2FsbF9zaW1pbGFyaXR5X3RocmVzaG9sZCJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX21lbW9yaWVzX21heF9zZWFyY2giLAogICAgICAgICAgICAidGl0bGUiOiAiTWVtb3J5IGF1dG8tcmVjYWxsIG1heCBtZW1vcmllcyB0byBzZWFyY2giLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGhlIG1heGltdW0gbnVtYmVyIG9mIG1lbW9yaWVzIHJldHVybmVkIGJ5IHZlY3RvciBEQiBmb3IgZnVydGhlciBwcm9jZXNzaW5nLiIsCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJtZW1vcnlfcmVjYWxsX21lbW9yaWVzX21heF9zZWFyY2giXSwKICAgICAgICB9CiAgICApCgogICAgbWVtb3J5X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAibWVtb3J5X3JlY2FsbF9tZW1vcmllc19tYXhfcmVzdWx0IiwKICAgICAgICAgICAgInRpdGxlIjogIk1lbW9yeSBhdXRvLXJlY2FsbCBtYXggbWVtb3JpZXMgdG8gdXNlIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBtYXhpbXVtIG51bWJlciBvZiBtZW1vcmllcyB0byBpbmplY3QgaW50byBBMCdzIGNvbnRleHQgd2luZG93LiIsCiAgICAgICAgICAgICJ0eXBlIjogIm51bWJlciIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJtZW1vcnlfcmVjYWxsX21lbW9yaWVzX21heF9yZXN1bHQiXSwKICAgICAgICB9CiAgICApCgogICAgbWVtb3J5X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAibWVtb3J5X3JlY2FsbF9zb2x1dGlvbnNfbWF4X3NlYXJjaCIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJNZW1vcnkgYXV0by1yZWNhbGwgbWF4IHNvbHV0aW9ucyB0byBzZWFyY2giLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGhlIG1heGltdW0gbnVtYmVyIG9mIHNvbHV0aW9ucyByZXR1cm5lZCBieSB2ZWN0b3IgREIgZm9yIGZ1cnRoZXIgcHJvY2Vzc2luZy4iLAogICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1sibWVtb3J5X3JlY2FsbF9zb2x1dGlvbnNfbWF4X3NlYXJjaCJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfZmllbGRzLmFwcGVuZCgKICAgICAgICB7CiAgICAgICAgICAgICJpZCI6ICJtZW1vcnlfcmVjYWxsX3NvbHV0aW9uc19tYXhfcmVzdWx0IiwKICAgICAgICAgICAgInRpdGxlIjogIk1lbW9yeSBhdXRvLXJlY2FsbCBtYXggc29sdXRpb25zIHRvIHVzZSIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgbWF4aW11bSBudW1iZXIgb2Ygc29sdXRpb25zIHRvIGluamVjdCBpbnRvIEEwJ3MgY29udGV4dCB3aW5kb3cuIiwKICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbIm1lbW9yeV9yZWNhbGxfc29sdXRpb25zX21heF9yZXN1bHQiXSwKICAgICAgICB9CiAgICApCgogICAgbWVtb3J5X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAibWVtb3J5X21lbW9yaXplX2VuYWJsZWQiLAogICAgICAgICAgICAidGl0bGUiOiAiQXV0by1tZW1vcml6ZSBlbmFibGVkIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkEwIHdpbGwgYXV0b21hdGljYWxseSBtZW1vcml6ZSBmYWN0cyBhbmQgc29sdXRpb25zIGZyb20gY29udmVyc2F0aW9uIGhpc3RvcnkuIiwKICAgICAgICAgICAgInR5cGUiOiAic3dpdGNoIiwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbIm1lbW9yeV9tZW1vcml6ZV9lbmFibGVkIl0sCiAgICAgICAgfQogICAgKQoKICAgIG1lbW9yeV9maWVsZHMuYXBwZW5kKAogICAgICAgIHsKICAgICAgICAgICAgImlkIjogIm1lbW9yeV9tZW1vcml6ZV9jb25zb2xpZGF0aW9uIiwKICAgICAgICAgICAgInRpdGxlIjogIkF1dG8tbWVtb3JpemUgQUkgY29uc29saWRhdGlvbiIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBMCB3aWxsIGF1dG9tYXRpY2FsbHkgY29uc29saWRhdGUgc2ltaWxhciBtZW1vcmllcyB1c2luZyB1dGlsaXR5IExMTS4gSW1wcm92ZXMgbWVtb3J5IHF1YWxpdHkgb3ZlciB0aW1lLCBhZGRzIDIgdXRpbGl0eSBMTE0gY2FsbHMgcGVyIG1lbW9yeS4iLAogICAgICAgICAgICAidHlwZSI6ICJzd2l0Y2giLAogICAgICAgICAgICAidmFsdWUiOiBzZXR0aW5nc1sibWVtb3J5X21lbW9yaXplX2NvbnNvbGlkYXRpb24iXSwKICAgICAgICB9CiAgICApCgogICAgbWVtb3J5X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAibWVtb3J5X21lbW9yaXplX3JlcGxhY2VfdGhyZXNob2xkIiwKICAgICAgICAgICAgInRpdGxlIjogIkF1dG8tbWVtb3JpemUgcmVwbGFjZW1lbnQgdGhyZXNob2xkIiwKICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIk9ubHkgYXBwbGllcyB3aGVuIEFJIGNvbnNvbGlkYXRpb24gaXMgZGlzYWJsZWQuIFJlcGxhY2VzIHByZXZpb3VzIHNpbWlsYXIgbWVtb3JpZXMgd2l0aCBuZXcgb25lcyBiYXNlZCBvbiB0aGlzIHRocmVzaG9sZC4gMCA9IHJlcGxhY2UgZXZlbiBpZiBub3Qgc2ltaWxhciBhdCBhbGwsIDEgPSByZXBsYWNlIG9ubHkgaWYgZXhhY3QgbWF0Y2guIiwKICAgICAgICAgICAgInR5cGUiOiAicmFuZ2UiLAogICAgICAgICAgICAibWluIjogMCwKICAgICAgICAgICAgIm1heCI6IDEsCiAgICAgICAgICAgICJzdGVwIjogMC4wMSwKICAgICAgICAgICAgInZhbHVlIjogc2V0dGluZ3NbIm1lbW9yeV9tZW1vcml6ZV9yZXBsYWNlX3RocmVzaG9sZCJdLAogICAgICAgIH0KICAgICkKCiAgICBtZW1vcnlfc2VjdGlvbjogU2V0dGluZ3NTZWN0aW9uID0gewogICAgICAgICJpZCI6ICJtZW1vcnkiLAogICAgICAgICJ0aXRsZSI6ICJNZW1vcnkiLAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJDb25maWd1cmF0aW9uIG9mIEEwJ3MgbWVtb3J5IHN5c3RlbS4gQTAgbWVtb3JpemVzIGFuZCByZWNhbGxzIG1lbW9yaWVzIGF1dG9tYXRpY2FsbHkgdG8gaGVscCBpdCdzIGNvbnRleHQgYXdhcmVuZXNzLiIsCiAgICAgICAgImZpZWxkcyI6IG1lbW9yeV9maWVsZHMsCiAgICAgICAgInRhYiI6ICJhZ2VudCIsCiAgICB9CgogICAgZGV2X2ZpZWxkczogbGlzdFtTZXR0aW5nc0ZpZWxkXSA9IFtdCgogICAgZGV2X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAic2hlbGxfaW50ZXJmYWNlIiwKICAgICAgICAgICAgInRpdGxlIjogIlNoZWxsIEludGVyZmFjZSIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUZXJtaW5hbCBpbnRlcmZhY2UgdXNlZCBmb3IgQ29kZSBFeGVjdXRpb24gVG9vbC4gTG9jYWwgUHl0aG9uIFRUWSB3b3JrcyBsb2NhbGx5IGluIGJvdGggZG9ja2VyaXplZCBhbmQgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnRzLiBTU0ggYWx3YXlzIGNvbm5lY3RzIHRvIGRvY2tlcml6ZWQgZW52aXJvbm1lbnQgKGF1dG9tYXRpY2FsbHkgYXQgbG9jYWxob3N0IG9yIFJGQyBob3N0IGFkZHJlc3MpLiIsCiAgICAgICAgICAgICJ0eXBlIjogInNlbGVjdCIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJzaGVsbF9pbnRlcmZhY2UiXSwKICAgICAgICAgICAgIm9wdGlvbnMiOiBbeyJ2YWx1ZSI6ICJsb2NhbCIsICJsYWJlbCI6ICJMb2NhbCBQeXRob24gVFRZIn0sIHsidmFsdWUiOiAic3NoIiwgImxhYmVsIjogIlNTSCJ9XSwKICAgICAgICB9CiAgICApCgogICAgaWYgcnVudGltZS5pc19kZXZlbG9wbWVudCgpOgogICAgICAgICMgZGV2X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgIyAgICB7CiAgICAgICAgIyAgICAgICAgICJpZCI6ICJyZmNfYXV0b19kb2NrZXIiLAogICAgICAgICMgICAgICAgICAidGl0bGUiOiAiUkZDIEF1dG8gRG9ja2VyIE1hbmFnZW1lbnQiLAogICAgICAgICMgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQXV0b21hdGljYWxseSBjcmVhdGUgZG9ja2VyaXplZCBpbnN0YW5jZSBvZiBBMCBmb3IgUkZDcyB1c2luZyB0aGlzIGluc3RhbmNlJ3MgY29kZSBiYXNlIGFuZCwgc2V0dGluZ3MgYW5kIC5lbnYuIiwKICAgICAgICAjICAgICAgICAgInR5cGUiOiAidGV4dCIsCiAgICAgICAgIyAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJyZmNfYXV0b19kb2NrZXIiXSwKICAgICAgICAjICAgICB9CiAgICAgICAgIyApCgogICAgICAgIGRldl9maWVsZHMuYXBwZW5kKAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiaWQiOiAicmZjX3VybCIsCiAgICAgICAgICAgICAgICAidGl0bGUiOiAiUkZDIERlc3RpbmF0aW9uIFVSTCIsCiAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVVJMIG9mIGRvY2tlcml6ZWQgQTAgaW5zdGFuY2UgZm9yIHJlbW90ZSBmdW5jdGlvbiBjYWxscy4gRG8gbm90IHNwZWNpZnkgcG9ydCBoZXJlLiIsCiAgICAgICAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJyZmNfdXJsIl0sCiAgICAgICAgICAgIH0KICAgICAgICApCgogICAgZGV2X2ZpZWxkcy5hcHBlbmQoCiAgICAgICAgewogICAgICAgICAgICAiaWQiOiAicmZjX3Bhc3N3b3JkIiwKICAgICAgICAgICAgInRpdGxlIjogIlJGQyBQYXNzd29yZCIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJQYXNzd29yZCBmb3IgcmVtb3RlIGZ1bmN0aW9uIGNhbGxzLiBQYXNzd29yZHMgbXVzdCBtYXRjaCBvbiBib3RoIGluc3RhbmNlcy4gUkZDcyBjYW4gbm90IGJlIHVzZWQgd2l0aCBlbXB0eSBwYXNzd29yZC4iLAogICAgICAgICAgICAidHlwZSI6ICJwYXNzd29yZCIsCiAgICAgICAgICAgICJ2YWx1ZSI6ICgKICAgICAgICAgICAgICAgIFBBU1NXT1JEX1BMQUNFSE9MREVSCiAgICAgICAgICAgICAgICBpZiBkb3RlbnYuZ2V0X2RvdGVudl92YWx1ZShkb3RlbnYuS0VZX1JGQ19QQVNTV09SRCkKICAgICAgICAgICAgICAgIGVsc2UgIiIKICAgICAgICAgICAgKSwKICAgICAgICB9CiAgICApCgogICAgaWYgcnVudGltZS5pc19kZXZlbG9wbWVudCgpOgogICAgICAgIGRldl9maWVsZHMuYXBwZW5kKAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiaWQiOiAicmZjX3BvcnRfaHR0cCIsCiAgICAgICAgICAgICAgICAidGl0bGUiOiAiUkZDIEhUVFAgcG9ydCIsCiAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiSFRUUCBwb3J0IGZvciBkb2NrZXJpemVkIGluc3RhbmNlIG9mIEEwLiIsCiAgICAgICAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJyZmNfcG9ydF9odHRwIl0sCiAgICAgICAgICAgIH0KICAgICAgICApCgogICAgICAgIGRldl9maWVsZHMuYXBwZW5kKAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiaWQiOiAicmZjX3BvcnRfc3NoIiwKICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJSRkMgU1NIIHBvcnQiLAogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlNTSCBwb3J0IGZvciBkb2NrZXJpemVkIGluc3RhbmNlIG9mIEEwLiIsCiAgICAgICAgICAgICAgICAidHlwZSI6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IHNldHRpbmdzWyJyZmNfcG9ydF9zc2giXSwKICAgICAgICAgICAgfQogICAgICAgICkKCiAgICBkZXZfc2VjdGlvbjogU2V0dGluZ3NTZWN0aW9uID0gewogICAgICAgICJpZCI6ICJkZXYiLAogICAgICAgICJ0aXRsZSI6ICJEZXZlbG9wbWVudCIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogIlBhcmFtZXRlcnMgZm9yIEEwIGZyYW1ld29yayBkZXZlbG9wbWVudC4gUkZDcyAocmVtb3RlIGZ1bmN0aW9uIGNhbGxzKSBhcmUgdXNlZCB0byBjYWxsIGZ1bmN0aW9ucyBvbiBhbm90aGVyIEEwIGluc3RhbmNlLiBZb3UgY2FuIGRldmVsb3AgYW5kIGRlYnVnIEEwIG5hdGl2ZWx5IG9uIHlvdXIgbG9jYWwgc3lzdGVtIHdoaWxlIHJlZGlyZWN0aW5nIHNvbWU...